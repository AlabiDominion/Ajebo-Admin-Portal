@model ShiftSolutions.web.Application.Org.StaffEditVm
@{
    ViewData["Title"] = "Edit Staff";
}

<div class="pageTitleBox d-sm-flex align-items-center justify-content-between">
    <h4>Edit Staff</h4>
    <p>Staff <span>></span> <span>Edit</span></p>
</div>

<div class="AddNewStaff">
    <h1 class="mb-2">Edit Staff</h1>

    <div asp-validation-summary="ModelOnly" class="text-danger mb-2"></div>

    <form asp-action="Edit" method="post" class="NewStaffInputField flex" enctype="multipart/form-data">
        @Html.AntiForgeryToken()
        <input type="hidden" asp-for="Id" />
        <input type="hidden" asp-for="ExistingAvatarUrl" />

        <div class="NSIF1">
            <div class="avatarUploader">
                <div class="mainavatar">
                    <svg viewBox="0 0 128 128" aria-hidden="true" style="display:@(string.IsNullOrWhiteSpace(Model.ExistingAvatarUrl) ? "block" : "none")">
                        <circle cx="64" cy="64" r="62" fill="#F5F7FA" stroke="#E5EAF0" />
                        <circle cx="64" cy="50" r="22" fill="none" stroke="#B8C2CC" stroke-width="6" />
                        <path d="M25,108c9-18,25-28,39-28s30,10,39,28" fill="none" stroke="#B8C2CC" stroke-width="6" stroke-linecap="round" />
                    </svg>
                    <img id="avatarPreview" alt="Avatar preview" src="@(string.IsNullOrWhiteSpace(Model.ExistingAvatarUrl) ? "" : Model.ExistingAvatarUrl)" style="display:@(string.IsNullOrWhiteSpace(Model.ExistingAvatarUrl) ? "none" : "block")" />
                </div>

                <label class="uploadBtn">
                    <input asp-for="Avatar" type="file" id="avatarInput" accept="image/*" hidden />
                    Change Image
                </label>
                <span asp-validation-for="Avatar" class="text-danger"></span>
            </div>

            <h4>Department & Role</h4>

            <div class="flex flex-column NSIF11">
                <label for="DepartmentId">Department</label>
                <select asp-for="DepartmentId" asp-items="ViewBag.Departments">
                    <option value="">-- Select Department --</option>
                </select>
                <span asp-validation-for="DepartmentId" class="text-danger"></span>
            </div>

            <div class="flex flex-column NSIF11">
                <label for="BusinessRoleId">Role</label>
                <select asp-for="BusinessRoleId" asp-items="ViewBag.BusinessRoles">
                    <option value="">-- Select Role --</option>
                </select>
                <span asp-validation-for="BusinessRoleId" class="text-danger"></span>
            </div>

            <div class="flex flex-column NSIF11">
                <label for="DateJoined">Date Joined</label>
                <input asp-for="DateJoined" type="date" />
                <span asp-validation-for="DateJoined" class="text-danger"></span>
            </div>

            <div class="flex flex-column NSIF11">
                <label for="Status">Status</label>
                <select asp-for="Status">
                    <option>Active</option>
                    <option>Inactive</option>
                    <option>On Leave</option>
                </select>
                <span asp-validation-for="Status" class="text-danger"></span>
            </div>

            <button type="submit" class="mt-2 btn btn-success custom-toggle">
                <span class="icon-on"><i class="ri-thumb-up-line align-bottom me-1"></i> Save</span>
            </button>
        </div>

        <div class="NSIF2">
            <h4>Personal Information</h4>
            <div class="flex column-gap-2">
                <div class="flex flex-column NSIF11">
                    <label for="FirstName">First Name</label>
                    <input asp-for="FirstName" type="text" />
                    <span asp-validation-for="FirstName" class="text-danger"></span>
                </div>

                <div class="flex flex-column NSIF11">
                    <label for="LastName">Last Name</label>
                    <input asp-for="LastName" type="text" />
                    <span asp-validation-for="LastName" class="text-danger"></span>
                </div>
            </div>

            <div class="flex flex-column NSIF11">
                <label for="Email">Email</label>
                <input asp-for="Email" type="email" />
                <span asp-validation-for="Email" class="text-danger"></span>
            </div>

            <div class="flex flex-column NSIF11">
                <label for="Phone">Phone</label>
                <input asp-for="Phone" type="text" />
                <span asp-validation-for="Phone" class="text-danger"></span>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        const input = document.getElementById('avatarInput');
        const preview = document.getElementById('avatarPreview');
        input?.addEventListener('change', () => {
            const file = input.files?.[0];
            if (!file) return;
            const url = URL.createObjectURL(file);
            preview.src = url;
            preview.style.display = 'block';
            preview.onload = () => {
                preview.previousElementSibling && (preview.previousElementSibling.style.display = 'none');
                URL.revokeObjectURL(url);
            };
        });
    </script>
}
