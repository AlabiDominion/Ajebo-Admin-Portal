<div class="pageTitleBox  d-sm-flex align-items-center justify-content-between">
    <h4>Orders / Bookings</h4>
    <p>Transactions <span>></span> <span>Orders / Bookings</span></p>
</div>


<!-- ===================== ORDERS / BOOKINGS — DETAILS ===================== -->
<div class="OBD p-4">
    <!-- Breadcrumb / Header strip -->
    <div class="obd-head">
        <div>
            <h2 class="obd-title">Order <span class="mono">ORD-12001</span></h2>
            <div class="obd-sub">Created: 2025-08-12 14:21 · Payment: Card (VISA)</div>
        </div>
        <div class="obd-actions">
            <button class="btn btn-light" id="resendReceipt">Resend Receipt</button>
            <button class="btn btn-light">Contact Merchant</button>
            <div class="manual-dropdown">
                <button class="btn btn-ghost" data-dd-button aria-haspopup="true" aria-expanded="false">More ▾</button>
                <ul class="dd-menu" role="menu">
                    <li><button class="dd-item" type="button">Mark as Completed</button></li>
                    <li><button class="dd-item" type="button">Add Adjustment</button></li>
                    <li><button class="dd-item" type="button">Add to Settlement</button></li>
                </ul>
            </div>
            <button class="btn btn-danger" id="openRefund">Refund</button>
        </div>
    </div>

    <!-- Top summary chips -->
    <div class="obd-chips">
        <span class="chip chip-type">Booking</span>
        <span class="chip chip-status chip-paid">Paid</span>
        <span class="chip">Stay: 12 Aug → 15 Aug (3 nights)</span>
        <span class="chip">Gateway Ref: <span class="mono">GW-9X2C7</span></span>
    </div>

    <!-- Two-column layout -->
    <div class="obd-grid">
        <!-- LEFT: main cards -->
        <div class="obd-col">
            <!-- Price Breakdown -->
            <div class="card">
                <div class="card-h">
                    <h3>Price Breakdown</h3>
                    <div class="kpi-row">
                        <div><span class="kpi-title">Selling</span><span class="kpi-value">₦245,000</span></div>
                        <div><span class="kpi-title">Base</span><span class="kpi-value">₦210,000</span></div>
                        <div><span class="kpi-title">Margin</span><span class="kpi-value green">+16.7% (₦35,000)</span></div>
                    </div>
                </div>
                <div class="stack">
                    <div class="stack-row"><span>Base Price (Merchant)</span><span class="mono">₦210,000</span></div>
                    <div class="stack-row"><span>Markup (Platform)</span><span class="mono">₦35,000</span></div>
                    <div class="stack-row"><span>Discount (Promo AJ-BACK2SCHOOL)</span><span class="mono">₦0</span></div>
                    <div class="stack-row"><span>Taxes & Fees</span><span class="mono">₦0</span></div>
                    <div class="stack-row total"><span>Total Paid</span><span class="mono">₦245,000</span></div>
                </div>
            </div>

            <!-- Customer -->
            <div class="card">
                <div class="card-h"><h3>Customer</h3></div>
                <div class="info">
                    <div class="info-row"><span>Name</span><span>Adewale O.</span></div>
                    <div class="info-row"><span>Email</span><span class="link">adewale@example.com</span></div>
                    <div class="info-row"><span>Phone</span><span>+234 803 555 0123</span></div>
                    <div class="info-row"><span>Notes</span><span>—</span></div>
                </div>
            </div>

            <!-- Merchant & Apartment -->
            <div class="card">
                <div class="card-h"><h3>Merchant & Apartment</h3></div>
                <div class="info">
                    <div class="info-row"><span>Merchant</span><span class="link">Stellar Apartments</span></div>
                    <div class="info-row"><span>Apartment</span><span>Unit A12 · Victoria Island</span></div>
                    <div class="info-row"><span>Payout (scheduled)</span><span class="mono">₦210,000</span></div>
                    <div class="info-row"><span>Settlement Batch</span><span class="muted">Not assigned</span></div>
                </div>
            </div>
        </div>

        <!-- RIGHT: timeline & meta -->
        <div class="obd-col">
            <!-- Timeline -->
            <div class="card">
                <div class="card-h"><h3>Timeline</h3></div>
                <ol class="timeline">
                    <li>
                        <div class="tl-dot tl-ok"></div>
                        <div class="tl-block">
                            <div class="tl-title">Paid</div>
                            <div class="tl-sub">2025-08-12 14:22 · Auth code: <span class="mono">A6FZ2</span></div>
                        </div>
                    </li>
                    <li>
                        <div class="tl-dot"></div>
                        <div class="tl-block">
                            <div class="tl-title">Created</div>
                            <div class="tl-sub">2025-08-12 14:21</div>
                        </div>
                    </li>
                </ol>
            </div>

            <!-- Order meta -->
            <div class="card">
                <div class="card-h"><h3>Order Meta</h3></div>
                <div class="info">
                    <div class="info-row"><span>Order ID</span><span class="mono">ORD-12001</span></div>
                    <div class="info-row"><span>Type</span><span>Booking</span></div>
                    <div class="info-row"><span>Channel</span><span>Web</span></div>
                    <div class="info-row"><span>Payment Method</span><span>Card (VISA)</span></div>
                    <div class="info-row"><span>Promo</span><span class="muted">None</span></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Refund modal (simple) -->
<div class="obd-overlay" id="refundOverlay" aria-hidden="true">
    <div class="obd-modal" role="dialog" aria-modal="true" aria-labelledby="refundTitle">
        <button class="modal-close" id="refundClose" aria-label="Close">×</button>
        <h3 id="refundTitle">Issue Refund</h3>
        <p class="muted">Choose refund type and amount. Partial refunds reduce platform revenue accordingly.</p>
        <form class="refund-form" action="/transactions/refund/ORD-12001" method="post">
            <div class="rf-row">
                <label>Refund Type</label>
                <select>
                    <option>Full</option>
                    <option>Partial</option>
                </select>
            </div>
            <div class="rf-row">
                <label>Amount</label>
                <input type="number" min="0" step="500" value="245000">
            </div>
            <div class="rf-row">
                <label>Reason</label>
                <input type="text" placeholder="Duplicate, customer request, etc.">
            </div>
            <div class="rf-actions">
                <button type="submit" class="btn btn-danger">Confirm Refund</button>
                <button type="button" class="btn btn-light" id="refundCancel">Cancel</button>
            </div>
        </form>
    </div>
</div>

<style>
    /* ==================== Scoped styles ==================== */
    .OBD{--bd:#e9edf4;--mut:#6b7280;--ink:#0f172a;--chip:#f1f5f9;--ok:#16a34a;--warn:#b45309;--err:#dc2626;--card:#fff}
    .OBD .mono{font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
    .OBD .muted{color:var(--mut)}

    .obd-head{display:flex;align-items:flex-start;justify-content:space-between;gap:16px;margin-bottom:10px}
    .obd-kicker{font-size:12px;color:#64748b;text-transform:uppercase;letter-spacing:.04em}
    .obd-title{font-size:24px;font-weight:800;margin:2px 0}
    .obd-sub{font-size:13px;color:var(--mut)}
    .obd-actions{display:flex;gap:8px;flex-wrap:wrap}

    .btn{height:36px;border-radius:10px;padding:0 14px;font-weight:600;border:1px solid var(--bd);background:#fff;color:var(--ink);cursor:pointer}
    .btn:hover{background:#f8fafc}
    .btn-danger{background:var(--err);border-color:var(--err);color:#fff}
    .btn-light{background:#fff}
    .btn-ghost{background:#fff}

    .obd-chips{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0 14px}
    .chip{padding:4px 10px;border-radius:999px;background:var(--chip);border:1px solid var(--bd);font-weight:600;font-size:12px}
    .chip-type{background:#eef2ff;border-color:#dbe1ff;color:#3730a3}
    .chip-status{background:#e6f4ff;border-color:#cfe4ff}
    .chip-paid{color:#1d4ed8}

    /* Layout grid */
    .obd-grid{display:grid;grid-template-columns: 1.15fr .85fr;gap:14px}
    

    .card{background:var(--card);border:1px solid var(--bd);border-radius:14px;padding:14px 14px 10px}
    .card-h{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
    .card h3{font-size:16px;margin:0;font-weight:700}
    .kpi-row{display:flex;gap:14px;flex-wrap:wrap}
    .kpi-title{display:block;font-size:11px;color:#6b7280}
    .kpi-value{display:block;font-weight:800}
    .kpi-value.green{color:#117B34}

    /* Stack list (price) */
    .stack{display:grid;gap:8px}
    .stack-row{display:flex;justify-content:space-between;align-items:center;font-size:14px}
    .stack-row.total{border-top:1px dashed var(--bd);padding-top:10px;font-weight:800}

    /* Simple info list */
    .info{display:grid;gap:8px}
    .info-row{display:flex;justify-content:space-between;gap:16px}
    .info-row .link{color:#2563eb;cursor:pointer;text-decoration:none}
    .info-row .link:hover{text-decoration:underline}

    /* Timeline */
    .timeline{list-style:none;margin:0;padding:0}
    .timeline li{display:flex;gap:10px;position:relative;padding:8px 0}
    .tl-dot{width:10px;height:10px;border-radius:999px;background:#94a3b8;margin-top:5px}
    .tl-ok{background:var(--ok)}
    .tl-block{flex:1}
    .tl-title{font-weight:700}
    .tl-sub{font-size:13px;color:var(--mut)}

    /* Dropdown */
    .manual-dropdown{position:relative;display:inline-block}
    .manual-dropdown .dd-menu{position:absolute;right:0;top:110%;min-width:11rem;background:#fff;border:1px solid var(--bd);border-radius:10px;box-shadow:0 12px 24px rgba(2,6,23,.1);display:none;z-index:50}
    .manual-dropdown .dd-item{display:block;padding:.55rem .8rem;font-size:14px;color:#334155;background:#fff;border:0;width:100%;text-align:left;cursor:pointer}
    .manual-dropdown .dd-item:hover{background:#f8fafc}
    .manual-dropdown .dd-menu.show{display:block}

    /* Modal (refund) */
    .obd-overlay{position:fixed;inset:0;background:rgba(2,6,23,.45);display:none;align-items:center;justify-content:center;padding:16px;z-index:9999}
    .obd-overlay.show{display:flex}
    .obd-modal{width:100%;max-width:520px;background:#fff;border:1px solid var(--bd);border-radius:14px;box-shadow:0 20px 48px rgba(2,6,23,.18);padding:16px 16px 12px}
    .modal-close{position:absolute;margin-left:auto;right:20px;top:14px;width:30px;height:30px;border:1px solid var(--bd);border-radius:8px;background:#fff;cursor:pointer}
    .refund-form{display:grid;gap:10px;margin-top:8px}
    .rf-row{display:grid;gap:6px}
    .rf-row input,.rf-row select{height:38px;border:1px solid #d0d5dd;border-radius:10px;padding:0 10px}
    .rf-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:6px}
</style>

<script>
    /* tiny interactions */
    (function(){
      // dropdown
      function closeAll(except){document.querySelectorAll('.manual-dropdown .dd-menu.show').forEach(m=>{if(m!==except) m.classList.remove('show')})}
      document.addEventListener('click', e=>{
        const btn = e.target.closest('[data-dd-button]');
        if(btn){
          const menu = btn.parentElement.querySelector('.dd-menu');
          const open = menu.classList.contains('show');
          closeAll();
          if(!open) menu.classList.add('show');
          e.stopPropagation();
        } else if(!e.target.closest('.manual-dropdown')){
          closeAll();
        }
      });
      document.addEventListener('keydown', e=>{ if(e.key==='Escape') closeAll(); });

      // refund modal
      const overlay = document.getElementById('refundOverlay');
      const openRefund = document.getElementById('openRefund');
      const closeRefund = document.getElementById('refundClose');
      const cancelRefund = document.getElementById('refundCancel');

      function openM(){ overlay.classList.add('show'); document.body.style.overflow='hidden'; }
      function closeM(){ overlay.classList.remove('show'); document.body.style.overflow=''; }

      openRefund?.addEventListener('click', openM);
      closeRefund?.addEventListener('click', closeM);
      cancelRefund?.addEventListener('click', closeM);
      overlay?.addEventListener('click', (e)=>{ if(e.target===overlay) closeM(); });
    })();
</script>

